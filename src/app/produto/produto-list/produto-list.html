<div class="produto-list-container">
  <div class="page-header">
    <h1>Produtos</h1>
    <button class="btn-add" (click)="navigateToForm()">+ Adicionar Produto</button>
  </div>

  <div *ngIf="mensagemSucesso" class="message success">{{ mensagemSucesso }}</div>
  <div *ngIf="mensagemErro" class="message error">{{ mensagemErro }}</div>

  <div class="toolbar">
    <div class="toolbar-top">
      <input 
        type="text" 
        class="search-bar" 
        placeholder="Buscar por nome do produto..." 
        [(ngModel)]="termoBusca"
        (ngModelChange)="onSearchChange($event)"
      />
    </div>

    <nav class="tabs">
      <a [routerLink]="['/produtos/ativos']" routerLinkActive="active-tab">Ativos</a>
      <a [routerLink]="['/produtos/inativos']" routerLinkActive="active-tab">Inativos</a>
      <a [routerLink]="['/produtos/todos']" routerLinkActive="active-tab">Todos</a>
    </nav>
  </div>

  <div class="table-container" *ngIf="!loading; else loadingTemplate">
    <table *ngIf="produtos.length > 0; else semProdutos">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nome</th>
          <th>Preço (Unidade)</th>
          <th>Preço (KG)</th>
          <th>Validade</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let produto of produtos">
          <td>{{ produto.id }}</td>
          <td>{{ produto.nome }}</td>
          <td>{{ produto.precoUnidade | currency:'BRL' }}</td>
          <td>{{ produto.precoKg | currency:'BRL' }}</td>
          <td>{{ produto.dataValidade | date:'dd/MM/yyyy' }}</td>
          <td>
            <span class="badge" [class.badge-ativo]="produto.ativo" [class.badge-inativo]="!produto.ativo">
              {{ produto.ativo ? 'Ativo' : 'Inativo' }}
            </span>
          </td>
          <td class="actions">
            <button class="btn-edit" (click)="editarProduto(produto.id)" *ngIf="produto.ativo">Editar</button>
            <button class="btn-delete" (click)="desativarProduto(produto.id)" *ngIf="produto.ativo">Desativar</button>
            <button class="btn-activate" (click)="ativarProduto(produto.id)" *ngIf="!produto.ativo">Ativar</button>
          </td>
        </tr>
      </tbody>
    </table>

    <ng-template #semProdutos>
      <p class="empty-state">Nenhum produto encontrado.</p>
    </ng-template>
  </div>

  <ng-template #loadingTemplate>
    <p class="empty-state">Carregando produtos...</p>
  </ng-template>
</div>