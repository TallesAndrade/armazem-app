<div class="estoque-page-container">
  <div class="page-header">
    <h1>Estoque de Produtos</h1>
  </div>

  <div class="toolbar">
    <div class="toolbar-top">
      <input type="text" class="search-bar" placeholder="Buscar por nome do produto..." [(ngModel)]="termoBusca"
        (ngModelChange)="onSearchChange($event)" />
    </div>

    <nav class="tabs">
      <a [routerLink]="['/estoque/ativos']" routerLinkActive="active-tab">Ativos</a>
      <a [routerLink]="['/estoque/inativos']" routerLinkActive="active-tab">Inativos</a>
      <a [routerLink]="['/estoque/todos']" routerLinkActive="active-tab">Todos</a>
    </nav>
  </div>

  <div class="table-container" *ngIf="!loading; else loadingTemplate">
    <table *ngIf="estoques.length > 0; else semEstoques">
      <thead>
        <tr>
          <th>ID Produto</th>
          <th>Nome do Produto</th>
          <th>Qtd. (Kg)</th>
          <th>Qtd. (Un)</th>
          <th>Estoque Mínimo</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let estoque of estoques">
          <td>{{ estoque.produtoId }}</td>
          <td>{{ estoque.produtoNome }}</td>
          <td>{{ estoque.quantidadeKg }}</td>
          <td>{{ estoque.quantidadeUnidades }}</td>
          <td>{{ estoque.quantidadeMinima }}</td>
          <td>
            <span class="badge badge-zerado" *ngIf="estoque.ativo && isEstoqueZerado(estoque)">
              Zerado
            </span>
            <span class="badge badge-baixo"
              *ngIf="estoque.ativo && !isEstoqueZerado(estoque) && isEstoqueBaixo(estoque)">
              Baixo
            </span>
            <span class="badge badge-ativo"
              *ngIf="estoque.ativo && !isEstoqueZerado(estoque) && !isEstoqueBaixo(estoque)">
              OK
            </span>
            <span class="badge badge-inativo" *ngIf="!estoque.ativo">
              Inativo
            </span>
          </td>

          <button class="btn-ajustar" (click)="ajustarEstoque(estoque.id)">Ajustar Saldo</button>
        </tr>
      </tbody>
    </table>

    <ng-template #semEstoques>
      <p class="empty-state">Nenhum estoque encontrado.</p>
    </ng-template>
  </div>

  <ng-template #loadingTemplate>
    <p class="empty-state">Carregando estoques...</p>
  </ng-template>
</div>