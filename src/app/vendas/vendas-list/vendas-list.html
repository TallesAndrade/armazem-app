<div class="vendas-list-container">
  <div class="page-header">
    <h1>Vendas</h1>
    <button class="btn-add" (click)="novaVenda()">+ Nova Venda</button>
  </div>

  <div *ngIf="mensagemSucesso" class="message success">{{ mensagemSucesso }}</div>
  <div *ngIf="mensagemErro" class="message error">{{ mensagemErro }}</div>

  <div class="toolbar">
    <nav class="tabs">
      <a (click)="alterarFiltro('abertas')" [class.active-tab]="filtroAtivo === 'abertas'">Abertas</a>
      <a (click)="alterarFiltro('finalizadas')" [class.active-tab]="filtroAtivo === 'finalizadas'">Finalizadas</a>
      <a (click)="alterarFiltro('todas')" [class.active-tab]="filtroAtivo === 'todas'">Todas</a>
    </nav>
  </div>

  <div class="table-container">
    <table *ngIf="vendas.length > 0; else semVendas">
      <thead>
        <tr>
          <th>ID</th>
          <th>Data</th>
          <th>Qtd. Itens</th>
          <th>Valor Total</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let venda of vendas">
          <td>{{ venda.id }}</td>
          <td>{{ venda.dataVenda | date:'dd/MM/yyyy' }}</td>
          <td>{{ venda.produtosVenda.length }}</td>
          <td>{{ venda.valorTotal | currency:'BRL' }}</td>
          <td>
            <span class="badge" [class.badge-aberta]="venda.status === 'ABERTA'" [class.badge-finalizada]="venda.status === 'FINALIZADA'">
              {{ venda.status === 'ABERTA' ? 'Aberta' : 'Finalizada' }}
            </span>
          </td>
          <td class="actions">
            <button class="btn-edit" (click)="editarVenda(venda.id)" *ngIf="venda.status === 'ABERTA'">Editar</button>
            <button class="btn-delete" (click)="cancelarVenda(venda.id, $event)" *ngIf="venda.status === 'ABERTA'">Cancelar</button>
          </td>
        </tr>
      </tbody>
    </table>

    <ng-template #semVendas>
      <p class="empty-state">Nenhuma venda encontrada.</p>
    </ng-template>
  </div>
</div>